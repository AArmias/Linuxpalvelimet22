# h5 - DJ Ango!

Alla neljännen kotitehtävän palautus. Tehtävä tehty 21.9.2022 omalla henkilökohtaisella koneellani.

Pääkone:

- Windows 10 Pro 
- 32GB RAM 
- 2TB levytilaa 

Virtuaalikoneen kokoonpano:

- Oracle VirtualBox 6.1.36 
- Ubuntu 22.04.1 
- Apache 2 
- 8192MB RAM 
- 25GB levytilaa

Lisäksi: 

- Pilvipalvelin vuokrattu DigitalOceanista. 
- Nimipalvelu hankittu Name.comista 
- Käytetty apuna Github Educationin etuja ja alennuksia. 


### a) CRUD. Make a simple web program, that allows multiple users modify the same data. Have user accounts and logins. You can use Django development server and admin interface here. Single table is enough. We already did a Customer (CRM) database, so it might be interesting to do something as simple, but slightly different. ####

Alkuun päästään normaalilla toimenpiteellä, eli päivitetään ohjelmistot. 
Seuraavaksi `sudo apt-get update` ja `sudo apt-get upgrade`. Nyt on ohjelmistot ja paketit päivitettynä ja voidaan aloittaa Djangon asentaminen. Alkuun päästään käskyllä `sudo apt-get -y install virtualenv`, joka käytännössä luo uuden digitaalisen kehitysympäristön jossa Djangoa voidaan ajaa. 
Seuraavaksi luodaan uusi kansio viimeisimmillä paketti päivityksillä käskyllä `virtualenv --system-site-packages -p python3 env/`.
![image](https://user-images.githubusercontent.com/102689055/192516826-4d3a6733-6152-4b0a-989b-b1464d9ce50b.png)


Nyt aktivoidaan juuri asennettu ja luotu virtuaali ympäristö käyttöön käskyllä `source env/bin/activate`.
![image](https://user-images.githubusercontent.com/102689055/192516956-0a2b019e-2145-4baa-b959-96da7d8e5b2c.png)
Nyt meillä näkyy (env) lyhenne rivillä ennen käyttäjätunnusta. Ollaan siis kehitysympäristön puolella.  

Djangon asennus tapahtuu täällä kehitysympäristössä micro editoria apuna käyttäen. Mikäli sitä ei löydy voi sen asentaa käskyllä `sudo apt-get install micro`. Koska itseltäni se löytyy pääsin suoraa luomaan "asennustiedoston" tai "käskyn" djangoa varten. Eli `micro requirements.txt` ja editoriin rivi **django** (ctrl+s tallentaa ja ctrl+q sulee editorin). 

Seuraavaksi asennetaan django requirement tiedostoa apuna käyttäen käskyllä: `pip install -r requirements.txt`
![image](https://user-images.githubusercontent.com/102689055/192519781-e3b92cf5-cb20-4e42-b85b-2fed158d788a.png)

Nyt django on asennettu! 
Käskyllä `django-admin --version` voidaan selvittää asentunut versio. 
![image](https://user-images.githubusercontent.com/102689055/192525360-96648869-643e-410d-a107-f9e4497050a7.png)
Eli asensimme version 4.1.1 

Aloitetaan uusi projekti, koska tulevana viikonloppuna on luvassa yhteisöristeily, lähtiöitä on pitkälti yli 50 henkeä ja jokainen on varannut oman matkansa, kokeillaan luoda tietokanta hyteistä ja niissä asuvista henkilöistä (pelkästään etunimet). Näin saadaan helposti laskettua samalla miten monta hyttiä meidän porukalla on. Luodaan siis uus projekti nimellä **hyttilista** `django-admin startproject hyttilista`, seuraavaksi `cd hyttilista` ja `./manage.py runserver`

Laitetaan selaimen osoitteeksi http://127.0.0.1:8000/ ja saadaan seilaimessa seuraava ilmoitus:
![image](https://user-images.githubusercontent.com/102689055/192526861-43ebe535-7966-4672-9e13-f8293ea8d6b1.png)

Päätteen puolella taas näky on tälläinen: 
![image](https://user-images.githubusercontent.com/102689055/192526596-331fce5a-5bbb-461d-8797-fcb9873811ce.png)

Suljetaan serveri hetkeksi painamalla ctrl-c ja päivitetään database käskyillä `./manage.py makemigrations` ja `./manage.py migrate`
![image](https://user-images.githubusercontent.com/102689055/192528308-1f4501c9-ed70-4118-a480-ce7a5337a8a2.png)

Luodaan seuraavaksi käyttäjä jolla voidaan kirjautua sisälle ja hallita tietokantaa. Käyttäjän luominen tapahtuu käskyllä `./manage.py createsuperuser`.
Mikäli tuntuu, että et keksi salasanaa voit asentaa salasanan luomista helpottavan salasanageneraattorin. Tämä onnistuu käskyllä `sudo apt-get install pwgen` ja salasanan luominen tapahtuu käskyllä `pwgen -s 20 1`. Kun käyttäjän nimi ja salasana on annettu, voidaan serveri käynnistää uudelleen ja katsoa toimiiko meidän käyttäjätunnus. Avataan osoite http://127.0.0.1:8000/admin/ annetaan tehty käyttäjänimi ja salasana ja ollaan sisällä! 
![image](https://user-images.githubusercontent.com/102689055/192530525-83347221-db6b-4a90-9b04-dda6d591c0c0.png)

Kokeilin luoda hallintasivujen kautta testikäyttäjän eli kayttaja1, nimeltään Testi Timo ja tavallisilla oikeuksilla. Käyttjän luominen tapahtui helposti klikkaamalla + Add painiketta Users ryhmän perässä. 
![image](https://user-images.githubusercontent.com/102689055/192533307-cc15644c-2fbc-4d7d-b373-3d75fcc4ce42.png)

Lisäksi loin toisen käyttäjätunnuksen, joka on **staff1** (Firman Mies) ja jolle laitan staff ja superuser oikeudet. 
![image](https://user-images.githubusercontent.com/102689055/192534104-f148a99b-e51c-4bbf-95b6-8750d3f360ba.png)

Suljin serverin, jotta pääsen muokkaamaan testiympäristössä tietokannan tietoja. 

Luodaan sovellus / tietokanta hytit käskyllä `./manage.py startapp hytit` ja lisätään tietokanta hyttilistat sovelluksen käyttöön `micro hyttilistat/settings.py`
Kuvan mukaisesti: 
![image](https://user-images.githubusercontent.com/102689055/192535613-9e28425f-cb9b-4772-a1fe-f805e6a9f600.png)


![image](https://user-images.githubusercontent.com/102689055/192541833-c121ab63-a947-4714-908b-6fcf978e6921.png)



![image](https://user-images.githubusercontent.com/102689055/192540585-1e9c1b55-8b8e-46dc-974a-e9504ed44e5b.png)




**Lähteet:**

- Karvinen 2022: Django 4 Instant Customer Database Tutorial - https://terokarvinen.com/2022/django-instant-crm-tutorial/
- Karvinen 2020: Command Line Basics Revisited - 
https://terokarvinen.com/2020/command-line-basics-revisited/
